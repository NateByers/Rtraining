library(ggplot2)
library(leaflet)
library(plotly)

chicago_air <- read.csv(text = '
                        "date","ozone","temp","solar","month","weekday"
                        "2013-01-01",0.032,17,0.65,1,3
                        "2013-01-02",0.02,15,0.61,1,4
                        "2013-01-03",0.021,28,0.17,1,5
                        "2013-01-04",0.028,18,0.62,1,6
                        "2013-01-05",0.025,26,0.48,1,7
                        "2013-01-06",0.026,36,0.47,1,1
                        "2013-01-07",0.024,25,0.65,1,2
                        "2013-01-08",0.021,30,0.39,1,3
                        "2013-01-09",0.031,41,0.65,1,4
                        "2013-01-10",0.024,33,0.42,1,5
                        "2013-01-11",0.025,53,0.15,1,6
                        "2013-01-12",0.025,53,0.41,1,7
                        "2013-01-13",0.022,29,0.09,1,1
                        "2013-01-14",0.023,14,0.58,1,2
                        "2013-01-15",0.017,19,0.66,1,3
                        "2013-01-16",0.026,23,0.66,1,4
                        "2013-01-17",0.034,33,0.69,1,5
                        "2013-01-18",0.025,25,0.63,1,6
                        "2013-01-19",0.029,40,0.38,1,7
                        "2013-01-20",0.03,21,0.59,1,1
                        "2013-01-21",0.027,12,0.74,1,2
                        "2013-01-22",0.026,1,0.73,1,3
                        "2013-01-23",0.029,NA,0.21,1,4
                        "2013-01-24",0.028,NA,0.51,1,5
                        "2013-01-25",0.019,NA,0.31,1,6
                        "2013-01-26",0.024,NA,0.74,1,7
                        "2013-01-27",0.014,NA,0.16,1,1
                        "2013-01-28",0.01,NA,0.32,1,2
                        "2013-01-29",0.017,NA,0.19,1,3
                        "2013-01-30",0.025,NA,0.14,1,4
                        "2013-01-31",0.026,NA,0.61,1,5
                        "2013-02-01",0.021,-17,0.81,2,6
                        "2013-02-02",0.024,22,0.34,2,7
                        "2013-02-03",0.032,14,0.76,2,1
                        "2013-02-04",0.032,26,0.04,2,2
                        "2013-02-05",0.026,26,0.21,2,3
                        "2013-02-06",0.022,26,0.79,2,4
                        "2013-02-07",0.025,33,0.09,2,5
                        "2013-02-08",0.029,28,0.35,2,6
                        "2013-02-09",0.028,29,0.87,2,7
                        "2013-02-10",0.028,35,0.11,2,1
                        "2013-02-11",0.028,42,0.46,2,2
                        "2013-02-12",0.028,28,0.3,2,3
                        "2013-02-13",0.019,36,0.85,2,4
                        "2013-02-14",0.033,38,0.28,2,5
                        "2013-02-15",0.036,32,0.9,2,6
                        "2013-02-16",0.034,17,0.51,2,7
                        "2013-02-17",0.032,20,0.93,2,1
                        "2013-02-18",0.035,45,0.6,2,2
                        "2013-02-19",0.029,26,0.54,2,3
                        "2013-02-20",0.034,16,0.96,2,4
                        "2013-02-21",0.036,28,0.17,2,5
                        "2013-02-22",0.033,29,0.28,2,6
                        "2013-02-23",0.041,28,0.64,2,7
                        "2013-02-24",0.035,32,0.97,2,1
                        "2013-02-25",0.038,37,0.96,2,2
                        "2013-02-26",0.035,35,0.29,2,3
                        "2013-02-27",0.033,33,0.19,2,4
                        "2013-02-28",0.033,34,0.58,2,5
                        "2013-03-01",0.033,28,0.38,3,6
                        "2013-03-02",0.041,27,0.97,3,7
                        "2013-03-03",0.041,27,1.07,3,1
                        "2013-03-04",0.039,29,0.73,3,2
                        "2013-03-05",0.037,33,0.22,3,3
                        "2013-03-06",0.031,32,0.56,3,4
                        "2013-03-07",0.039,34,1.03,3,5
                        "2013-03-08",0.037,35,1.07,3,6
                        "2013-03-09",0.03,38,0.5,3,7
                        "2013-03-10",0.036,46,0.17,3,1
                        "2013-03-11",0.028,47,0.22,3,2
                        "2013-03-12",0.039,34,1.05,3,3
                        "2013-03-13",0.04,26,1.14,3,4
                        "2013-03-14",0.031,35,0.76,3,5
                        "2013-03-15",0.035,40,0.58,3,6
                        "2013-03-16",0.039,35,0.36,3,7
                        "2013-03-17",0.043,31,0.83,3,1
                        "2013-03-18",0.039,31,0.22,3,2
                        "2013-03-19",0.042,24,1.19,3,3
                        "2013-03-20",0.036,21,1.21,3,4
                        "2013-03-21",0.034,26,1.2,3,5
                        "2013-03-22",0.04,32,1.2,3,6
                        "2013-03-23",0.045,34,1.21,3,7
                        "2013-03-24",0.038,35,0.87,3,1
                        "2013-03-25",0.038,35,0.87,3,2
                        "2013-03-26",0.039,38,1.13,3,3
                        "2013-03-27",0.04,40,0.55,3,4
                        "2013-03-28",0.044,44,1.23,3,5
                        "2013-03-29",0.051,47,1.23,3,6
                        "2013-03-30",0.052,52,0.95,3,7
                        "2013-03-31",0.049,50,1.16,3,1
                        "2013-04-01",0.044,34,1.24,4,2
                        "2013-04-02",0.045,37,1.28,4,3
                        "2013-04-03",0.048,39,1.17,4,4
                        "2013-04-04",0.055,49,1.27,4,5
                        "2013-04-05",0.044,42,1.3,4,6
                        "2013-04-06",0.052,55,0.71,4,7
                        "2013-04-07",0.042,52,1.27,4,1
                        "2013-04-08",0.038,60,1.04,4,2
                        "2013-04-09",0.035,40,0.83,4,3
                        "2013-04-10",0.037,39,0.2,4,4
                        "2013-04-11",0.032,40,0.14,4,5
                        "2013-04-12",0.037,42,0.5,4,6
                        "2013-04-13",0.037,39,0.85,4,7
                        "2013-04-14",0.044,42,1.3,4,1
                        "2013-04-15",0.035,61,0.8,4,2
                        "2013-04-16",0.041,47,1.34,4,3
                        "2013-04-17",0.037,42,0.25,4,4
                        "2013-04-18",0.035,51,0.16,4,5
                        "2013-04-19",0.037,39,0.48,4,6
                        "2013-04-20",0.049,38,1.39,4,7
                        "2013-04-21",0.051,44,1.2,4,1
                        "2013-04-22",0.054,59,1.33,4,2
                        "2013-04-23",0.036,58,0.3,4,3
                        "2013-04-24",0.048,40,1.22,4,4
                        "2013-04-25",0.046,45,0.83,4,5
                        "2013-04-26",0.054,60,1.29,4,6
                        "2013-04-27",0.062,61,1.37,4,7
                        "2013-04-28",0.052,53,1.27,4,1
                        "2013-04-29",0.054,67,1.22,4,2
                        "2013-04-30",0.059,74,1.37,4,3
                        "2013-05-01",0.068,80,1.36,5,4
                        "2013-05-02",0.029,45,1.22,5,5
                        "2013-05-03",0.024,41,0.42,5,6
                        "2013-05-04",0.048,59,1.21,5,7
                        "2013-05-05",0.053,55,1.41,5,1
                        "2013-05-06",0.055,56,1.1,5,2
                        "2013-05-07",0.059,61,1.38,5,3
                        "2013-05-08",0.065,71,1.35,5,4
                        "2013-05-09",0.045,64,0.61,5,5
                        "2013-05-10",0.026,45,0.38,5,6
                        "2013-05-11",0.043,55,1.12,5,7
                        "2013-05-12",0.039,46,1.38,5,1
                        "2013-05-13",0.045,49,1.44,5,2
                        "2013-05-14",0.081,74,1.4,5,3
                        "2013-05-15",0.058,78,1.38,5,4
                        "2013-05-16",0.057,73,1.41,5,5
                        "2013-05-17",0.034,58,1.05,5,6
                        "2013-05-18",0.055,68,1.35,5,7
                        "2013-05-19",0.069,73,1.21,5,1
                        "2013-05-20",0.069,81,1.38,5,2
                        "2013-05-21",0.055,74,1.27,5,3
                        "2013-05-22",0.039,71,1.09,5,4
                        "2013-05-23",0.033,51,1.09,5,5
                        "2013-05-24",0.034,48,1.49,5,6
                        "2013-05-25",0.038,49,0.92,5,7
                        "2013-05-26",0.051,56,1.22,5,1
                        "2013-05-27",0.042,55,0.27,5,2
                        "2013-05-28",0.033,72,0.93,5,3
                        "2013-05-29",0.055,71,1.37,5,4
                        "2013-05-30",0.038,82,1.09,5,5
                        "2013-05-31",0.054,76,1.09,5,6
                        "2013-06-01",0.049,73,0.96,6,7
                        "2013-06-02",0.018,NA,0.26,6,1
                        "2013-06-03",0.039,NA,1.44,6,2
                        "2013-06-04",0.05,NA,1.23,6,3
                        "2013-06-05",0.051,63,0.87,6,4
                        "2013-06-06",0.04,55,0.87,6,5
                        "2013-06-07",0.05,57,1.44,6,6
                        "2013-06-08",0.053,68,1.41,6,7
                        "2013-06-09",0.067,74,1.07,6,1
                        "2013-06-10",0.051,68,1.45,6,2
                        "2013-06-11",0.066,78,1.23,6,3
                        "2013-06-12",0.056,72,0.9,6,4
                        "2013-06-13",0.04,64,1.46,6,5
                        "2013-06-14",0.035,59,1.43,6,6
                        "2013-06-15",0.047,65,0.74,6,7
                        "2013-06-16",0.064,79,1.27,6,1
                        "2013-06-17",0.062,84,1.44,6,2
                        "2013-06-18",0.033,57,1.43,6,3
                        "2013-06-19",0.046,67,1.46,6,4
                        "2013-06-20",0.074,80,1.35,6,5
                        "2013-06-21",0.048,81,0.6,6,6
                        "2013-06-22",0.049,70,0.95,6,7
                        "2013-06-23",0.058,82,1.35,6,1
                        "2013-06-24",0.053,74,1.36,6,2
                        "2013-06-25",0.041,72,0.98,6,3
                        "2013-06-26",0.046,73,1.11,6,4
                        "2013-06-27",0.05,83,1.35,6,5
                        "2013-06-28",0.052,78,1.4,6,6
                        "2013-06-29",0.038,64,1.01,6,7
                        "2013-06-30",0.046,65,1.31,6,1
                        "2013-07-01",NA,65,1.33,7,2
                        "2013-07-02",NA,62,0.85,7,3
                        "2013-07-03",NA,62,0.92,7,4
                        "2013-07-04",NA,NA,1.07,7,5
                        "2013-07-05",NA,NA,1.36,7,6
                        "2013-07-06",NA,NA,1.19,7,7
                        "2013-07-07",NA,NA,1.29,7,1
                        "2013-07-08",NA,NA,1.2,7,2
                        "2013-07-09",NA,NA,1.04,7,3
                        "2013-07-10",NA,NA,1.25,7,4
                        "2013-07-11",NA,NA,1.41,7,5
                        "2013-07-12",NA,NA,1.47,7,6
                        "2013-07-13",NA,NA,1.44,7,7
                        "2013-07-14",NA,NA,1.38,7,1
                        "2013-07-15",NA,56,1.14,7,2
                        "2013-07-16",NA,87,1.28,7,3
                        "2013-07-17",NA,88,1.44,7,4
                        "2013-07-18",NA,90,1.25,7,5
                        "2013-07-19",NA,92,1.37,7,6
                        "2013-07-20",NA,79,1.38,7,7
                        "2013-07-21",NA,79,1.37,7,1
                        "2013-07-22",NA,80,1.21,7,2
                        "2013-07-23",NA,71,1.19,7,3
                        "2013-07-24",NA,66,1.39,7,4
                        "2013-07-25",NA,72,1.36,7,5
                        "2013-07-26",0.029,69,0.29,7,6
                        "2013-07-27",0.021,61,0.89,7,7
                        "2013-07-28",0.023,60,1.15,7,1
                        "2013-07-29",0.036,66,1.19,7,2
                        "2013-07-30",0.025,73,0.92,7,3
                        "2013-07-31",0.043,67,0.5,7,4
                        "2013-08-01",0.041,75,1.32,8,5
                        "2013-08-02",0.045,77,1.15,8,6
                        "2013-08-03",0.027,73,1.4,8,7
                        "2013-08-04",0.031,68,1.4,8,1
                        "2013-08-05",0.033,69,0.95,8,2
                        "2013-08-06",0.044,73,1,8,3
                        "2013-08-07",0.056,82,1.05,8,4
                        "2013-08-08",0.035,68,1.29,8,5
                        "2013-08-09",0.05,78,1.13,8,6
                        "2013-08-10",0.047,74,1.3,8,7
                        "2013-08-11",0.048,74,0.92,8,1
                        "2013-08-12",0.048,79,0.95,8,2
                        "2013-08-13",0.033,65,1.34,8,3
                        "2013-08-14",0.033,65,1.37,8,4
                        "2013-08-15",0.042,72,1.21,8,5
                        "2013-08-16",0.055,73,1.32,8,6
                        "2013-08-17",0.054,74,1.33,8,7
                        "2013-08-18",0.066,74,1.31,8,1
                        "2013-08-19",0.064,78,1.2,8,2
                        "2013-08-20",0.061,82,1.16,8,3
                        "2013-08-21",0.058,85,1.16,8,4
                        "2013-08-22",0.04,74,0.41,8,5
                        "2013-08-23",0.035,73,1.3,8,6
                        "2013-08-24",0.06,79,1.24,8,7
                        "2013-08-25",0.06,84,1.2,8,1
                        "2013-08-26",0.053,84,1.01,8,2
                        "2013-08-27",0.057,89,1.18,8,3
                        "2013-08-28",NA,81,0.77,8,4
                        "2013-08-29",0.047,77,1.23,8,5
                        "2013-08-30",0.056,88,1.13,8,6
                        "2013-08-31",0.039,72,0.7,8,7
                        "2013-09-01",0.044,76,1.13,9,1
                        "2013-09-02",0.027,70,1.05,9,2
                        "2013-09-03",0.035,67,1.23,9,3
                        "2013-09-04",0.047,76,1.18,9,4
                        "2013-09-05",0.036,69,1.23,9,5
                        "2013-09-06",0.052,76,1.15,9,6
                        "2013-09-07",0.05,83,1.11,9,7
                        "2013-09-08",0.038,71,0.46,9,1
                        "2013-09-09",0.078,83,1.11,9,2
                        "2013-09-10",0.059,91,1.15,9,3
                        "2013-09-11",0.045,81,0.95,9,4
                        "2013-09-12",0.034,72,1.18,9,5
                        "2013-09-13",0.035,60,1.2,9,6
                        "2013-09-14",0.041,64,1.19,9,7
                        "2013-09-15",0.029,60,0.09,9,1
                        "2013-09-16",0.03,61,1.02,9,2
                        "2013-09-17",0.039,64,0.97,9,3
                        "2013-09-18",0.047,74,1,9,4
                        "2013-09-19",0.035,70,0.87,9,5
                        "2013-09-20",0.029,73,0.71,9,6
                        "2013-09-21",0.024,61,0.98,9,7
                        "2013-09-22",0.034,59,0.97,9,1
                        "2013-09-23",0.041,58,1.16,9,2
                        "2013-09-24",0.043,64,1.14,9,3
                        "2013-09-25",0.049,63,1.08,9,4
                        "2013-09-26",0.05,66,1.14,9,5
                        "2013-09-27",0.051,73,1.1,9,6
                        "2013-09-28",0.05,74,1.07,9,7
                        "2013-09-29",0.03,60,1.1,9,1
                        "2013-09-30",0.033,65,1.04,9,2
                        "2013-10-01",0.044,68,0.92,10,3
                        "2013-10-02",0.041,66,1.05,10,4
                        "2013-10-03",0.022,66,0.46,10,5
                        "2013-10-04",0.025,70,0.53,10,6
                        "2013-10-05",0.025,75,0.62,10,7
                        "2013-10-06",0.029,59,0.99,10,1
                        "2013-10-07",0.029,NA,1.04,10,2
                        "2013-10-08",0.031,NA,1,10,3
                        "2013-10-09",0.036,NA,1,10,4
                        "2013-10-10",0.037,NA,0.97,10,5
                        "2013-10-11",0.057,NA,0.95,10,6
                        "2013-10-12",0.028,NA,0.69,10,7
                        "2013-10-13",0.03,NA,1.01,10,1
                        "2013-10-14",0.032,NA,0.99,10,2
                        "2013-10-15",0.018,NA,0.17,10,3
                        "2013-10-16",0.014,NA,0.3,10,4
                        "2013-10-17",0.015,NA,0.33,10,5
                        "2013-10-18",0.015,NA,0.28,10,6
                        "2013-10-19",0.027,NA,0.89,10,7
                        "2013-10-20",0.021,NA,0.53,10,1
                        "2013-10-21",0.024,NA,0.55,10,2
                        "2013-10-22",0.016,NA,0.46,10,3
                        "2013-10-23",0.023,NA,0.91,10,4
                        "2013-10-24",0.025,NA,0.91,10,5
                        "2013-10-25",0.028,NA,0.91,10,6
                        "2013-10-26",0.027,NA,0.7,10,7
                        "2013-10-27",0.024,NA,0.85,10,1
                        "2013-10-28",0.021,NA,0.75,10,2
                        "2013-10-29",0.014,NA,0.49,10,3
                        "2013-10-30",0.013,NA,0.33,10,4
                        "2013-10-31",0.015,NA,0.17,10,5
                        "2013-11-01",0.015,NA,0.22,11,6
                        "2013-11-02",0.015,NA,0.35,11,7
                        "2013-11-03",0.022,NA,0.81,11,1
                        "2013-11-04",0.023,NA,0.4,11,2
                        "2013-11-05",0.023,NA,0.22,11,3
                        "2013-11-06",0.021,NA,0.19,11,4
                        "2013-11-07",0.023,NA,0.62,11,5
                        "2013-11-08",0.027,NA,0.67,11,6
                        "2013-11-09",0.029,NA,0.72,11,7
                        "2013-11-10",0.028,NA,0.77,11,1
                        "2013-11-11",0.024,NA,0.06,11,2
                        "2013-11-12",0.025,NA,0.79,11,3
                        "2013-11-13",0.022,NA,0.74,11,4
                        "2013-11-14",0.022,NA,0.72,11,5
                        "2013-11-15",0.017,NA,0.64,11,6
                        "2013-11-16",0.021,NA,0.07,11,7
                        "2013-11-17",0.03,NA,0.3,11,1
                        "2013-11-18",0.022,NA,0.62,11,2
                        "2013-11-19",0.024,NA,0.72,11,3
                        "2013-11-20",0.016,NA,0.73,11,4
                        "2013-11-21",0.004,NA,0.22,11,5
                        "2013-11-22",0.023,NA,0.61,11,6
                        "2013-11-23",0.028,NA,0.66,11,7
                        "2013-11-24",0.028,NA,0.7,11,1
                        "2013-11-25",0.02,NA,0.19,11,2
                        "2013-11-26",0.024,NA,0.11,11,3
                        "2013-11-27",0.023,NA,0.7,11,4
                        "2013-11-28",0.018,NA,0.59,11,5
                        "2013-11-29",0.017,NA,0.69,11,6
                        "2013-11-30",0.023,NA,0.64,11,7
                        "2013-12-01",0.02,NA,0.46,12,1
                        "2013-12-02",0.02,NA,0.51,12,2
                        "2013-12-03",0.008,NA,0.15,12,3
                        "2013-12-04",0.011,NA,0.07,12,4
                        "2013-12-05",0.021,NA,0.57,12,5
                        "2013-12-06",0.019,NA,0.28,12,6
                        "2013-12-07",0.022,NA,0.66,12,7
                        "2013-12-08",0.03,NA,0.11,12,1
                        "2013-12-09",0.022,NA,0.62,12,2
                        "2013-12-10",0.028,NA,0.63,12,3
                        "2013-12-11",0.026,NA,0.49,12,4
                        "2013-12-12",0.02,NA,0.64,12,5
                        "2013-12-13",0.016,NA,0.55,12,6
                        "2013-12-14",0.022,NA,0.11,12,7
                        "2013-12-15",0.023,NA,0.36,12,1
                        "2013-12-16",0.017,NA,0.39,12,2
                        "2013-12-17",0.03,NA,0.56,12,3
                        "2013-12-18",0.023,NA,0.51,12,4
                        "2013-12-19",0.016,NA,0.26,12,5
                        "2013-12-20",0.02,NA,0.06,12,6
                        "2013-12-21",0.025,NA,0.06,12,7
                        "2013-12-22",0.026,NA,0.18,12,1
                        "2013-12-23",0.023,NA,0.64,12,2
                        "2013-12-24",0.015,NA,0.7,12,3
                        "2013-12-25",0.026,NA,0.14,12,4
                        "2013-12-26",0.026,NA,0.41,12,5
                        "2013-12-27",0.021,NA,0.62,12,6
                        "2013-12-28",0.026,NA,0.61,12,7
                        "2013-12-29",0.029,NA,0.08,12,1
                        "2013-12-30",0.024,NA,0.44,12,2
                        "2013-12-31",0.021,NA,0.49,12,3
                        ', stringsAsFactors = FALSE)
chicago_air$date <- as.Date(chicago_air$date)

# Define server logic required to plot the time series
shinyServer(function(input, output) {
  
  output$timePlot <- renderPlotly({
    g <- ggplot(chicago_air, aes_string("date", input$parameter)) + geom_point()
    ggplotly(g)
  })
  
  output$dataTable <- renderDataTable({
    chicago_air
  })
  
  output$mymap <- renderLeaflet({
    library(leaflet)
    m <- leaflet()
    m <- addTiles(m)
    m <- addMarkers(m, lng=-87.79923, lat=42.14)
    setView(m, lng=-87.79923, lat=42.14, zoom = 10)
  })
  
})