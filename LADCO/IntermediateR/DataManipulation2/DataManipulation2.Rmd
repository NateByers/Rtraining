---
title: 'Data Manipulation: Part 2'
output: 
  html_document: 
    theme: readable
---

This tutorial will cover the following functions in the `dplyr` package:

- [mutate() and transmute()](#mutate)

- [group_by() with filter()](#groupfilter)

- [group_by() with summarize()](#groupsum)

Advanced topics

- [Piping with %>%](#pipe)

## Make new columns with mutate() and transmute() {#mutate}

In the first <a href="http://rpubs.com/NateByers/DataManip1" target="_blank">Data Manipulation</a> tutorial we learned how to select just the columns we need by using the `select()`
function from `dplyr`. But in some cases we may want to add a new column. For example, 
in the `chicago_air` data set from the `region5air` package, we may want a column 
that is a one day lag value of the ozone column. To add a new column we use the 
`mutate()` function from the `dplyr` package. Again, the first parameter is
the data frame. Then we use the `lag()` function to create a new column of lagged
ozone values.

```{r, warning=FALSE, message=FALSE}
library(region5air)
library(dplyr)
data(chicago_air)
head(chicago_air)
d <- mutate(chicago_air, ozone_lag1 = lag(ozone, n = 1))
head(d, 3)
```

Or we may want to calculate the difference betwen the ozone value and a standard 
value.

```{r}
d <- mutate(d, diff_standard = ozone - 0.075)
head(d)
```

`transmute()` works the same as `mutate()` except that it only returns the new columns.

```{r}
d <- transmute(chicago_air, ozone_lag1 = lag(ozone, n = 1), 
               diff_standard = ozone - 0.075)
head(d)
```

You can keep a column by including it as a parameter.

```{r}
d <- transmute(chicago_air, date, ozone, lag1 = lag(ozone, n= 1))
head(d)
```

## Filter by groups with group_by() and filter()


```{r}
pollutants <- read.table(header=T, text='
  day   month  duration    value                 
    1    June        1h    0.050
    1    June        8h    0.040
    2    June        1h    0.060
    2    June        8h    0.050
    1    July        1h    0.055
    1    July        8h    0.045
    2    July        1h    0.065
    2    July        8h    0.052
                       ')

```

### When should you use filter() and when should you use summarise()?

- __Use `filter()`__ with `group_by()` when you want to keep all of the columns
but only the rows that meet a logical criteria among groups.

- __Use `summarize()`__ with `group_by()` when you need a summary of one column
for each group. You will only get the columns you grouped-by and the one column
you summarized.

# Exercises

Go to the <a href="http://rpubs.com/NateByers/DataManip2Exercises" target="_blank">exercises page</a> for this tutorial and test your comprehension of this material.
